# 日志系统说明

## 功能概述

应用已集成完整的日志系统，所有运行信息和错误都会自动保存到日志文件中，方便调试和问题排查。

## 日志位置

- **开发环境**：项目根目录下的 `logs/` 文件夹
- **打包后 exe**：exe 文件同级目录下的 `logs/` 文件夹

## 日志文件命名

- 格式：`app_YYYYMMDD.log`
- 示例：`app_20251229.log`（2025年12月29日的日志）
- 每天自动创建新的日志文件

## 日志级别

| 级别 | 说明 | 用途 |
|------|------|------|
| DEBUG | 详细调试信息 | 开发调试，记录详细的执行流程 |
| INFO | 一般信息 | 正常运行状态，重要操作记录 |
| WARNING | 警告信息 | 潜在问题，但不影响运行 |
| ERROR | 错误信息 | 运行错误，但程序可以继续 |
| CRITICAL | 严重错误 | 致命错误，程序无法继续运行 |

## 日志内容

日志会记录以下信息：

### 1. 启动信息
```
2025-12-29 20:33:46 [INFO] main - 应用启动开始
2025-12-29 20:33:46 [INFO] main - 运行模式: 开发模式
2025-12-29 20:33:46 [INFO] main - 工作目录: E:\...\MyLocalLLM
```

### 2. 初始化过程
```
2025-12-29 20:33:46 [INFO] main - 开始执行初始化检查...
2025-12-29 20:33:46 [INFO] main - 成功读取 models.json，模型数: 29
2025-12-29 20:33:46 [INFO] main - 成功导入 29 个模型配置
2025-12-29 20:33:46 [INFO] main - 成功导入 12 个人格配置
```

### 3. 数据库操作
```
2025-12-29 20:33:46 [INFO] database - 数据库初始化完成: E:\...\data.db
```

### 4. 错误信息（含完整堆栈）
```
2025-12-29 20:33:46 [ERROR] main - 应用启动失败: ...
Traceback (most recent call last):
  File "...", line 123, in <module>
    ...
Exception: ...
```

## 日志轮转

- **单文件大小限制**：10MB
- **备份文件数量**：保留最近 5 个备份
- **自动轮转**：超过大小限制时自动创建新文件（如 `app_20251229.log.1`）

## 查看日志

### 方法 1：文本编辑器
直接用记事本、VS Code 等打开 `.log` 文件

### 方法 2：命令行
```cmd
# 查看完整日志
type logs\app_20251229.log

# 查看最后 50 行
powershell Get-Content logs\app_20251229.log -Tail 50

# 实时监控日志（类似 tail -f）
powershell Get-Content logs\app_20251229.log -Wait -Tail 20
```

## 调试技巧

### 1. 查找错误
在日志文件中搜索 `[ERROR]` 或 `[CRITICAL]` 关键字

### 2. 追踪特定功能
搜索模块名称，如：
- `[INFO] initialization` - 初始化相关
- `[INFO] database` - 数据库相关
- `[INFO] migration` - 数据迁移相关

### 3. 查看详细调试信息
搜索 `[DEBUG]` 查看详细的执行流程

## 清理日志

可以安全删除旧的日志文件以释放磁盘空间，不会影响应用运行。

建议保留最近 7-30 天的日志文件。

## 提交问题时

如果遇到问题需要反馈，请附上相关的日志文件内容，这将大大提高问题定位效率。

特别是包含 `[ERROR]` 或 `[CRITICAL]` 的日志段落。
